import{a as R,b as k,c as v,e as z,f as A,h as q,i as B,k as D,l as G,m as j,n as W,o as $,p as Z}from"./chunk-ZQQKKS6M.js";import{Ba as p,Db as O,Fa as m,Fb as T,Nb as N,Oa as l,Pa as o,Qa as u,Qb as V,Ra as C,Sa as y,U as x,Ua as M,V as b,Xa as w,Ya as f,fb as _,gb as d,ib as I,jb as S,kb as E,lb as F,oa as a,ob as P,pb as L,ta as c,xa as h}from"./chunk-QPAO22JT.js";var K=()=>({standalone:!0});function Q(t,r){if(t&1&&(l(0,"div",17),d(1),o()),t&2){let n=f();a(),I(" ",n.apiError," ")}}function X(t,r){t&1&&(l(0,"p",20),d(1," Identifier is required "),o())}function Y(t,r){t&1&&(l(0,"p",20),d(1," Invalid format. Please enter a valid email (e.g.,user@example.com) or an Egyptian phone number starting with 010, 011, 012, or 015 and exactly 11 digits. "),o())}function ee(t,r){if(t&1&&(l(0,"div",18),p(1,X,2,0,"p",19)(2,Y,2,0,"p",19),o()),t&2){let n,e,i=f();a(),m("ngIf",(n=i.loginForm.get("identifier"))==null?null:n.getError("required")),a(),m("ngIf",(e=i.loginForm.get("identifier"))==null?null:e.getError("invalidIdentifier"))}}function te(t,r){t&1&&(l(0,"p",20),d(1," password is Required "),o())}function ne(t,r){t&1&&(l(0,"p",20),d(1," Password must be at least 8 characters and contain at least one uppercase letter, one lowercase letter, one number, and one special character. "),o())}function ie(t,r){if(t&1&&(l(0,"div",18),p(1,te,2,0,"p",19)(2,ne,2,0,"p",19),o()),t&2){let n,e,i=f();a(),m("ngIf",(n=i.loginForm.get("password"))==null?null:n.getError("required")),a(),m("ngIf",(e=i.loginForm.get("password"))==null?null:e.getError("pattern"))}}function oe(t,r){t&1&&(C(0),u(1,"span",21),d(2," Loading... "),y())}function re(t,r){t&1&&d(0,"Log In")}var J=class t{constructor(r,n,e){this._FormBuilder=r;this.authService=n;this.router=e}loginForm;apiError=null;isLoading=!1;rememberMe=!1;ngOnInit(){this.loginForm=this._FormBuilder.group({identifier:["",[this.identifierValidator]],password:["",[v.required,v.pattern(/^(?=.*[A-Z])(?=.*[a-z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,}$/)]]})}identifierValidator(r){let n=r.value,e=/^[^\s@]+@[^\s@]+\.[^\s@]+$/,i=/^(010|011|012|015)[0-9]{8}$/;return!n||n.trim()===""?{required:!0}:e.test(n)||i.test(n)?null:{invalidIdentifier:!0}}onSubmit(){if(console.log("Form submitted"),this.loginForm.invalid)return;this.apiError=null,this.isLoading=!0;let{identifier:r,password:n}=this.loginForm.value;this.authService.login(r,n).subscribe({next:e=>{this.isLoading=!1,console.log("ddd"),(this.rememberMe?localStorage:sessionStorage).setItem("loggedInUser",JSON.stringify(e)),console.log("ddd"),this.router.navigate(["/home"]),console.log("ddd")},error:e=>{this.isLoading=!1,this.apiError=e||"Invalid credentials"}})}static \u0275fac=function(n){return new(n||t)(c(j),c(Z),c(N))};static \u0275cmp=h({type:t,selectors:[["app-login"]],decls:26,vars:10,consts:[["inputIdentifier",""],["inputPass",""],["loginText",""],[1,"container","mt-5",2,"max-width","600px","margin","0 auto","min-height","100vh"],[1,"text-left",2,"color","#562ddd","font-size","34px","font-weight","700","margin-bottom","20px"],["class","dang text-center",4,"ngIf"],[1,"row","g-3",3,"ngSubmit","formGroup"],[1,"col-12"],["type","text","formControlName","identifier",1,"form-control"],["class","dang col mt-3",4,"ngIf"],["type","password","formControlName","password",1,"form-control"],[1,"form-check"],["type","checkbox","id","rememberMe",1,"form-check-input",3,"ngModelChange","ngModelOptions","ngModel"],["for","rememberMe",1,"form-check-label"],[1,"col-12","text-center"],["type","submit",1,"btn",2,"background-color","#562ddd","color","white","width","70%","font-size","22px","margin-top","5px","margin-bottom","10px",3,"disabled"],[4,"ngIf","ngIfElse"],[1,"dang","text-center"],[1,"dang","col","mt-3"],["class","dang",4,"ngIf"],[1,"dang"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm","me-2"]],template:function(n,e){if(n&1){let i=M();l(0,"div",3)(1,"h2",4),d(2," Log in to Employes Data "),o(),p(3,Q,2,1,"div",5),l(4,"form",6),w("ngSubmit",function(){return x(i),b(e.onSubmit())}),l(5,"div",7)(6,"label"),d(7,"Email or Phone Number"),o(),u(8,"input",8,0),p(10,ee,3,2,"div",9),o(),l(11,"div",7)(12,"label"),d(13,"Password"),o(),u(14,"input",10,1),p(16,ie,3,2,"div",9),o(),l(17,"div",11)(18,"input",12),F("ngModelChange",function(g){return x(i),E(e.rememberMe,g)||(e.rememberMe=g),b(g)}),o(),l(19,"label",13),d(20," Remember Me "),o()(),l(21,"div",14)(22,"button",15),p(23,oe,3,0,"ng-container",16)(24,re,1,0,"ng-template",null,2,L),o()()()()}if(n&2){let i,s,g=_(9),U=_(15),H=_(25);a(3),m("ngIf",e.apiError),a(),m("formGroup",e.loginForm),a(6),m("ngIf",((i=e.loginForm.get("identifier"))==null?null:i.errors)&&(((i=e.loginForm.get("identifier"))==null?null:i.touched)||g.value.length>0)),a(6),m("ngIf",((s=e.loginForm.get("password"))==null?null:s.errors)&&(((s=e.loginForm.get("password"))==null?null:s.touched)||U.value.length>0)),a(2),m("ngModelOptions",P(9,K)),S("ngModel",e.rememberMe),a(4),m("disabled",e.isLoading),a(),m("ngIf",e.isLoading)("ngIfElse",H)}},dependencies:[T,O,$,B,k,R,z,A,D,G,W,q,V],styles:[".login-container[_ngcontent-%COMP%]{max-width:400px;margin:50px auto;text-align:left;font-family:sans-serif}.styl[_ngcontent-%COMP%]{color:#562ddd;font-size:34px;font-weight:700;margin-bottom:20px}.login-container[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:#5e17eb}input[_ngcontent-%COMP%]{width:100%;padding:10px;margin-bottom:15px;box-sizing:border-box}.password-field[_ngcontent-%COMP%]{display:flex;align-items:center}.password-field[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:none;border:none;cursor:pointer}button[type=submit][_ngcontent-%COMP%]{width:100%;background-color:#5e17eb;color:#fff;padding:12px;border:none;border-radius:6px;font-weight:700}.forgot[_ngcontent-%COMP%]{color:red;display:block;margin-top:10px}.dang[_ngcontent-%COMP%]{color:red}input[_ngcontent-ng-c975759461][_ngcontent-%COMP%]{width:2%;padding:10px;margin-bottom:15px;box-sizing:border-box}input[type=text][_ngcontent-%COMP%], input[type=email][_ngcontent-%COMP%], input[type=password][_ngcontent-%COMP%], input[type=tel][_ngcontent-%COMP%]{width:100%;padding:10px;margin-bottom:15px;box-sizing:border-box}"]})};export{J as LoginComponent};
